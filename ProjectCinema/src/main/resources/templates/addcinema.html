<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.3.0/css/bootstrap.min.css}" />
    <link rel="stylesheet" th:href="@{/css/styles.css}" />
    <script th:src="@{/webjars/jquery/3.6.0/jquery.min.js}"></script>
    <title th:text="#{add.cinema.title}">Add Cinema</title>
</head>
<body class="pb-5">
<div th:insert="~{fragments :: navbar}"></div>

<div class="container pb-5">
    <h1 class="mt-4" th:text="#{add.cinema.title}">Add Cinema</h1>

    <!-- Display error message area -->
    <div id="errorMessage" class="alert alert-danger" style="display: none;" role="alert"></div>

    <form id="addCinemaForm" th:action="@{/addcinema}" method="post" th:object="${cinema}" enctype="multipart/form-data" class="pd-5">
        <div class="mb-3">
            <label for="name" class="form-label" th:text="#{cinema.name}">Cinema Name:</label>
            <input type="text" id="name" name="name" class="form-control" required>
            <div class="invalid-feedback" th:text="#{error.nameRequired}">Please enter the cinema name.</div>
        </div>

        <div class="mb-3">
            <label for="address" class="form-label" th:text="#{cinema.address}">Address:</label>
            <input type="text" id="address" name="address" class="form-control" required>
            <div class="invalid-feedback" th:text="#{error.addressRequired}">Please enter the address.</div>
        </div>

        <div class="mb-3">
            <label for="capacity" class="form-label" th:text="#{cinema.capacity}">Capacity:</label>
            <input type="number" id="capacity" name="capacity" class="form-control" required oninput="validateCapacity()">
            <div class="invalid-feedback" th:text="#{error.capacityRequired}">Please enter a valid capacity (must be at least 1).</div>
        </div>

        <div class="mb-3">
            <label for="image" class="form-label" th:text="#{cinema.image}">Image Name:</label>
            <input type="text" id="image" name="image" class="form-control" required>
            <div class="invalid-feedback" th:text="#{error.imageRequired1}">Please enter an image name.</div>
        </div>

        <button type="submit" class="btn btn-light text-dark border border-dark" th:text="#{add.cinema.button}">Add Cinema</button>
    </form>
</div>

<div th:insert="~{fragments :: footer}"></div>

<script>
    function validateCapacity() {
        const capacityInput = document.getElementById('capacity');
        const errorMessageDiv = document.getElementById('errorMessage');
        const capacity = parseInt(capacityInput.value);

        errorMessageDiv.style.display = 'none';

        if (capacity < 1) {
            errorMessageDiv.textContent = 'Capacity cannot be less than 1.';
            errorMessageDiv.style.display = 'block';
        }
    }

    document.getElementById('addCinemaForm').onsubmit = function (event) {
        const capacityInput = document.getElementById('capacity');
        const capacity = parseInt(capacityInput.value);

        if (capacity < 1) {
            event.preventDefault();
            validateCapacity();
        }
    };
</script>
</body>
</html>